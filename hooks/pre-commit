 #!/bin/sh
 
 # This is a pre-commit hook for git linting and formatting files about to be committed. To install locally:
 # cp hooks/pre-commit .git/hooks/pre-commit
 
 FILES=$(git diff --cached --name-only --diff-filter=ACMR | sed 's| |\\ |g')
 [ -z "$FILES" ] && exit 0
 
 # Check that ruff is installed
 [ -x "ruff" ] && echo "Commit failed since command 'ruff' not found: Install with 'pip install ruff --upgrade' " >&2 && exit 1
 
 # Apply lint check and formatting
 echo "$FILES" | xargs ruff check --fix --preview --silent
 echo "$FILES" | xargs ruff format --preview --silent
 
 # Add back modified files to staging
 echo "$FILES" | xargs git add
 
 exit 0
